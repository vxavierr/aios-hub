# Story CL2-015: Values Tasks VL-001 to VL-008

**Story ID:** CL2-015
**Epic:** EPIC-CLONE-LAB-V2
**Phase:** 2 - Validation
**Status:** Ready
**Points:** 5
**Author:** Morgan (PM)

---

## Description

Implementar as 8 Validation Tasks de Valores (VL-001 a VL-008), responsaveis por validar valores fundamentais, crenças e principios que guiam a personalidade sendo clonada.

### Problem Statement
Valores e crenças sao o nucleo da identidade de uma pessoa. Estas 8 tasks garantem que os valores identificados sao consistentes, autenticos e bem representados nos dados extraidos.

---

## Acceptance Criteria

```gherkin
Given values and beliefs data from extracted sources
When values tasks are executed
Then all 8 tasks return valid TaskResults

Given content with stated values
When VL-001 (Core Values Identification) runs
Then it identifies and validates core values

Given content showing values-behavior alignment
When VL-004 (Values-Behavior Alignment) runs
Then it validates consistency between values and actions

Given content with ethical positions
When VL-006 (Ethical Framework) runs
Then it validates ethical framework consistency
```

---

## Technical Requirements

### Task Definitions

| Task ID | Name | Description |
|---------|------|-------------|
| VL-001 | Core Values Identification | Identifica e valida valores fundamentais |
| VL-002 | Belief System Analysis | Analisa sistema de crenças |
| VL-003 | Priority Hierarchy | Valida hierarquia de prioridades |
| VL-004 | Values-Behavior Alignment | Verifica alinhamento valores-ações |
| VL-005 | Moral Reasoning | Valida raciocinio moral |
| VL-006 | Ethical Framework | Valida framework etico |
| VL-007 | Value Conflicts | Identifica conflitos de valores |
| VL-008 | Value Evolution | Analisa evolucao de valores ao longo do tempo |

### Implementation Example

```typescript
// packages/validation/src/tasks/values/vl-001-core-values.ts

import { IValidationTask, TaskContext, TaskResult, TaskDefinition } from '../task.interface';

export class VL001CoreValues implements IValidationTask {
  readonly definition: TaskDefinition = {
    id: 'VL-001',
    category: 'values',
    name: 'Core Values Identification',
    description: 'Identifies and validates core values from extracted content',
    requiredInputs: ['extractedData', 'mindResults'],
    outputs: ['coreValues', 'confidence', 'evidence'],
    timeout: 45000,
    retryable: true,
    priority: 'critical'
  };

  async execute(context: TaskContext): Promise<TaskResult> {
    const startTime = Date.now();
    const findings: TaskFinding[] = [];

    const valuesAnalysis = await this.analyzeCoreValues(context.extractedData);

    // Check for minimum values coverage
    if (valuesAnalysis.values.length < 3) {
      findings.push({
        type: 'warning',
        description: 'Few core values identified - may indicate insufficient data',
        severity: 'medium',
        evidence: `Only ${valuesAnalysis.values.length} values found`
      });
    }

    // Check for value consistency
    if (valuesAnalysis.consistency < 0.6) {
      findings.push({
        type: 'issue',
        description: 'Low consistency in value expression across sources',
        severity: 'high'
      });
    }

    const score = this.calculateScore(valuesAnalysis);

    return {
      taskId: this.definition.id,
      status: score >= 50 ? 'passed' : 'failed',
      score,
      confidence: valuesAnalysis.confidence,
      findings,
      recommendations: this.generateRecommendations(valuesAnalysis),
      executionTime: Date.now() - startTime,
      metadata: {
        valuesIdentified: valuesAnalysis.values,
        consistency: valuesAnalysis.consistency,
        sourcesAnalyzed: context.extractedData.length
      }
    };
  }

  private async analyzeCoreValues(data: ExtractedData[]): Promise<ValuesAnalysis> {
    const valueKeywords = [
      'integridade', 'honestidade', 'criatividade', 'inovacao',
      'qualidade', 'excelencia', 'colaboracao', 'autonomia',
      'liberdade', 'seguranca', 'crescimento', 'impacto',
      'familia', 'saude', 'conhecimento', 'justica'
    ];

    const extractedValues: ExtractedValue[] = [];

    for (const item of data) {
      const values = this.extractValuesFromContent(item.content, valueKeywords);
      extractedValues.push(...values.map(v => ({
        value: v,
        source: item.id,
        context: this.getValueContext(item.content, v)
      })));
    }

    const consolidatedValues = this.consolidateValues(extractedValues);

    return {
      values: consolidatedValues,
      consistency: this.calculateConsistency(extractedValues),
      confidence: this.calculateConfidence(extractedValues, data.length)
    };
  }

  private calculateScore(analysis: ValuesAnalysis): number {
    let score = 0;

    // Number of values found (up to 30 points)
    score += Math.min(30, analysis.values.length * 5);

    // Consistency score (up to 40 points)
    score += analysis.consistency * 40;

    // Confidence score (up to 30 points)
    score += analysis.confidence * 30;

    return Math.min(100, Math.round(score));
  }

  async validateInputs(context: TaskContext): Promise<boolean> {
    return context.extractedData.length > 0;
  }

  canExecute(context: TaskContext): boolean {
    return context.extractedData.length > 0;
  }

  getDependencies(): TaskId[] {
    return ['EX-001', 'EX-003']; // Source completeness and relevance
  }
}
```

### File Structure

```
packages/validation/src/tasks/values/
├── vl-001-core-values.ts
├── vl-002-belief-system.ts
├── vl-003-priority-hierarchy.ts
├── vl-004-values-behavior-alignment.ts
├── vl-005-moral-reasoning.ts
├── vl-006-ethical-framework.ts
├── vl-007-value-conflicts.ts
├── vl-008-value-evolution.ts
├── index.ts
└── __tests__/
    └── values-tasks.test.ts
```

---

## Business Value

As Values Tasks capturam o **nucleo moral e etico** da personalidade, que eh essencial para um clone que toma decisoes consistentes com os valores originais.

**Beneficios:**
- Valida autenticidade dos valores identificados
- Detecta inconsistencias entre valores declarados e praticados
- Fornece base para decisoes eticas do clone
- Aumenta credibilidade e confianca no clone

---

## Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Valores implicitos dificeis de detectar | High | Medium | Multi-pass analysis |
| Variacao contextual de valores | Medium | Medium | Considerar contexto |
| Crenças vs valores confusao | Low | Low | Taxonomia clara |

---

## Scope

### In Scope
- All 8 values task implementations
- Unit tests for each task
- Value extraction and consolidation logic
- Finding and recommendation generation

### Out of Scope
- Other task categories
- Task Registry & Executor
- CLI integration

---

## Dependencies

| Dependency | Type | Status |
|------------|------|--------|
| CL2-012 (Task Interface) | Package | Pending |
| CL2-013 (Extraction Tasks) | Package | Pending |
| @clone-lab/minds (Brene) | Package | Pending |

---

## Dev Notes

- Use value dictionaries and taxonomies
- Consider cultural context in value interpretation
- Implement temporal analysis for VL-008
- Add value strength scoring (how strongly held)

---

## File List

| File | Action | Status |
|------|--------|--------|
| `packages/validation/src/tasks/values/vl-001-core-values.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-002-belief-system.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-003-priority-hierarchy.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-004-values-behavior-alignment.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-005-moral-reasoning.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-006-ethical-framework.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-007-value-conflicts.ts` | Create | Pending |
| `packages/validation/src/tasks/values/vl-008-value-evolution.ts` | Create | Pending |
| `packages/validation/src/tasks/values/index.ts` | Create | Pending |
| `packages/validation/src/tasks/values/__tests__/values-tasks.test.ts` | Create | Pending |

---

## Definition of Done

- [ ] All 8 tasks implement IValidationTask correctly
- [ ] Each task returns valid TaskResult
- [ ] Values are accurately identified and validated
- [ ] Findings are descriptive and actionable
- [ ] Unit tests pass (coverage > 80%)
- [ ] Handles edge cases gracefully
- [ ] Lint passa sem erros
- [ ] Code review aprovado

---

## QA Checklist

- [ ] All 8 tasks execute without errors
- [ ] Task results are consistent
- [ ] Values are accurately detected
- [ ] Confidence scores are reasonable
- [ ] Edge cases handled

---

## Change Log

| Date | Author | Description |
|------|--------|-------------|
| 2026-02-20 | Morgan (PM) | Story created |

---

*Story generated by Morgan (PM Agent) - AIOS Framework*
