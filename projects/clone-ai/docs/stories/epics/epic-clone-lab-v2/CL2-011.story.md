# Story CL2-011: Mind Package Setup & Exports

**Story ID:** CL2-011
**Epic:** EPIC-CLONE-LAB-V2
**Phase:** 1 - Foundation
**Status:** Ready
**Points:** 2
**Author:** Morgan (PM)

---

## Description

Configurar o package `@clone-lab/minds` com todas as exports, configurações de build e estrutura de diretórios para suportar as 8 Minds e o Orchestrator.

### Problem Statement
O package minds precisa de uma estrutura organizada que permita importar minds individualmente ou em grupo, com builds otimizados e tree-shaking funcional.

---

## Acceptance Criteria

```gherkin
Given the minds package is installed
When I import a specific mind
Then only that mind's code is included

Given all minds are implemented
When I import from @clone-lab/minds
Then all minds are available

Given the package is built
When I check the dist folder
Then proper ESM and CJS outputs exist

Given TypeScript consumers
When they import from the package
Then types are properly exported
```

---

## Technical Requirements

### Package Structure

```
packages/minds/
├── src/
│   ├── base/
│   │   ├── mind.interface.ts
│   │   ├── types.ts
│   │   └── index.ts
│   ├── tim/
│   │   ├── extraction-mind.ts
│   │   ├── prompts.ts
│   │   ├── types.ts
│   │   └── index.ts
│   ├── daniel/
│   │   └── ...
│   ├── brene/
│   │   └── ...
│   ├── barbara/
│   │   └── ...
│   ├── charlie/
│   │   └── ...
│   ├── constantin/
│   │   └── ...
│   ├── quinn/
│   │   └── ...
│   ├── victoria/
│   │   └── ...
│   └── index.ts              # Main export
├── package.json
├── tsconfig.json
├── tsconfig.build.json
└── README.md
```

### Package Configuration

```json
// packages/minds/package.json
{
  "name": "@clone-lab/minds",
  "version": "1.0.0",
  "type": "module",
  "main": "./dist/index.cjs",
  "module": "./dist/index.js",
  "types": "./dist/index.d.ts",
  "exports": {
    ".": {
      "import": "./dist/index.js",
      "require": "./dist/index.cjs",
      "types": "./dist/index.d.ts"
    },
    "./tim": {
      "import": "./dist/tim/index.js",
      "types": "./dist/tim/index.d.ts"
    },
    "./daniel": {
      "import": "./dist/daniel/index.js",
      "types": "./dist/daniel/index.d.ts"
    },
    "./brene": {
      "import": "./dist/brene/index.js",
      "types": "./dist/brene/index.d.ts"
    },
    "./barbara": {
      "import": "./dist/barbara/index.js",
      "types": "./dist/barbara/index.d.ts"
    },
    "./charlie": {
      "import": "./dist/charlie/index.js",
      "types": "./dist/charlie/index.d.ts"
    },
    "./constantin": {
      "import": "./dist/constantin/index.js",
      "types": "./dist/constantin/index.d.ts"
    },
    "./quinn": {
      "import": "./dist/quinn/index.js",
      "types": "./dist/quinn/index.d.ts"
    },
    "./victoria": {
      "import": "./dist/victoria/index.js",
      "types": "./dist/victoria/index.d.ts"
    },
    "./base": {
      "import": "./dist/base/index.js",
      "types": "./dist/base/index.d.ts"
    }
  },
  "files": ["dist"],
  "scripts": {
    "build": "tsup",
    "dev": "tsup --watch",
    "typecheck": "tsc --noEmit",
    "lint": "eslint src",
    "test": "vitest"
  },
  "dependencies": {
    "@clone-lab/core": "workspace:*",
    "zod": "^3.22.0"
  },
  "devDependencies": {
    "tsup": "^8.0.0",
    "typescript": "^5.3.0",
    "vitest": "^1.0.0"
  }
}
```

### Main Export

```typescript
// packages/minds/src/index.ts

// Base types
export * from './base';

// All minds
export { TimMind } from './tim';
export { DanielMind } from './daniel';
export { BreneMind } from './brene';
export { BarbaraMind } from './barbara';
export { CharlieMind } from './charlie';
export { ConstantinMind } from './constantin';
export { QuinnMind } from './quinn';
export { VictoriaMind } from './victoria';

// Factory for creating all minds
import { TimMind } from './tim';
import { DanielMind } from './daniel';
import { BreneMind } from './brene';
import { BarbaraMind } from './barbara';
import { CharlieMind } from './charlie';
import { ConstantinMind } from './constantin';
import { QuinnMind } from './quinn';
import { VictoriaMind } from './victoria';
import type { IMind } from './base';

export function createAllMinds(): IMind[] {
  return [
    new TimMind(),
    new DanielMind(),
    new BreneMind(),
    new BarbaraMind(),
    new CharlieMind(),
    new ConstantinMind(),
    new QuinnMind(),
    new VictoriaMind()
  ];
}

// Mind registry for lookup
export const mindRegistry = new Map<string, () => IMind>([
  ['tim', () => new TimMind()],
  ['daniel', () => new DanielMind()],
  ['brene', () => new BreneMind()],
  ['barbara', () => new BarbaraMind()],
  ['charlie', () => new CharlieMind()],
  ['constantin', () => new ConstantinMind()],
  ['quinn', () => new QuinnMind()],
  ['victoria', () => new VictoriaMind()]
]);
```

---

## Business Value

Esta story garante que o package minds seja **usável e performático**. Uma estrutura de exports bem definida permite tree-shaking e DX (developer experience) superior.

**Benefícios:**
- Tree-shaking funcional (importar só o necessário)
- Tipos TypeScript corretos
- Builds ESM e CJS compatíveis
- Fácil de usar e testar

---

## Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Exports inconsistentes | Low | Medium | Testes de import |
| Build falha em CI | Low | High | CI build step |
| Tipos não exportados | Medium | Medium | Typecheck obrigatório |

---

## Scope

### In Scope
- Package.json configuration
- Tsconfig configuration
- Main export file
- Subpath exports
- Build configuration (tsup)
- README documentation

### Out of Scope
- Individual mind implementations
- Orchestrator
- CLI integration

---

## Dependencies

| Dependency | Type | Status |
|------------|------|--------|
| CL2-001 to CL2-009 (All Minds) | Package | Pending |
| tsup | Dev | Available |
| TypeScript 5.x | Dev | Available |

---

## Dev Notes

### Build with tsup

```typescript
// tsup.config.ts
import { defineConfig } from 'tsup';

export default defineConfig({
  entry: [
    'src/index.ts',
    'src/tim/index.ts',
    'src/daniel/index.ts',
    'src/brene/index.ts',
    'src/barbara/index.ts',
    'src/charlie/index.ts',
    'src/constantin/index.ts',
    'src/quinn/index.ts',
    'src/victoria/index.ts',
    'src/base/index.ts'
  ],
  format: ['cjs', 'esm'],
  dts: true,
  splitting: true,
  sourcemap: true,
  clean: true
});
```

---

## File List

| File | Action | Status |
|------|--------|--------|
| `packages/minds/package.json` | Update | Pending |
| `packages/minds/tsconfig.json` | Update | Pending |
| `packages/minds/tsup.config.ts` | Create | Pending |
| `packages/minds/src/index.ts` | Create | Pending |
| `packages/minds/README.md` | Create | Pending |

---

## Definition of Done

- [ ] Package builds successfully
- [ ] All exports work correctly
- [ ] Types are properly exported
- [ ] Tree-shaking works (verify bundle size)
- [ ] ESM and CJS outputs exist
- [ ] README documents usage
- [ ] Lint passa sem erros
- [ ] Code review aprovado

---

## QA Checklist

- [ ] Package builds successfully
- [ ] All exports work correctly
- [ ] Types are properly exported
- [ ] Tree-shaking verified
- [ ] README is complete

---

## Change Log

| Date | Author | Description |
|------|--------|-------------|
| 2026-02-20 | Morgan (PM) | Story created |

---

*Story generated by Morgan (PM Agent) - AIOS Framework*
