# Story CL2-061: System Health Monitor

**Story ID:** CL2-061
**Epic:** EPIC-CLONE-LAB-V2
**Phase:** 5 - Self-Evolution
**Status:** Ready
**Points:** 5
**Author:** Morgan (PM)

---

## Description

Implementar o **System Health Monitor** - componente que monitora continuamente a saúde do sistema Clone Lab, rastreando métricas de performance, qualidade e estabilidade.

---

## Acceptance Criteria

```gherkin
Given the system is running
When health check runs
Then all components are evaluated

Given a component is unhealthy
When the check completes
Then the overall health reflects this

Given health degrades over time
When trend is analyzed
Then early warning is generated
```

---

## Technical Requirements

### Health Monitor

```typescript
// packages/meta/src/health/monitor.ts

export interface HealthStatus {
  overall: 'healthy' | 'degraded' | 'unhealthy';
  score: number;  // 0-100
  components: ComponentHealth[];
  checkedAt: Date;
}

export class SystemHealthMonitor {
  private readonly checks: HealthCheck[];

  async checkHealth(): Promise<HealthStatus> {
    const components: ComponentHealth[] = [];

    for (const check of this.checks) {
      const health = await check.run();
      components.push(health);
    }

    const avgScore = components.reduce((sum, c) => sum + c.score, 0) / components.length;

    return {
      overall: avgScore >= 80 ? 'healthy' : avgScore >= 50 ? 'degraded' : 'unhealthy',
      score: avgScore,
      components,
      checkedAt: new Date()
    };
  }
}
```

### Health Checks

- **CloneOperationsHealthCheck**: Success rate, duration, errors
- **FidelityHealthCheck**: Average fidelity scores
- **EvolutionHealthCheck**: Rollback rate, pending approvals
- **StorageHealthCheck**: Disk usage, index health

---

## Business Value

Health Monitor fornece visibilidade contínua da saúde do sistema.

**Benefícios:** Detecção precoce de problemas, alertas automáticos, base para auto-diagnóstico

---

## Scope

### In Scope
- SystemHealthMonitor class
- Health checks for operations, fidelity, evolution
- Trend calculation, alert integration

### Out of Scope
- Real-time dashboard, auto-remediation

---

## Dependencies

| Dependency | Type | Status |
|------------|------|--------|
| CL2-029 (Metrics Collector) | Package | Pending |
| CL2-062 (Alert System) | Package | Pending |

---

## File List

| File | Action | Status |
|------|--------|--------|
| `packages/meta/src/health/monitor.ts` | Create | Pending |
| `packages/meta/src/health/checks.ts` | Create | Pending |
| `packages/meta/src/health/types.ts` | Create | Pending |
| `packages/meta/src/health/index.ts` | Create | Pending |

---

## Definition of Done

- [ ] Health monitor runs checks correctly
- [ ] All health checks implemented
- [ ] Alerts triggered when thresholds crossed
- [ ] Lint passa sem erros
- [ ] Code review aprovado

---

*Story generated by Morgan (PM Agent) - AIOS Framework*
