# Story TD-008: Implementar Tema Dark/Light

> **Story ID:** TD-008
> **Epic:** EPIC-TD-001 (Technical Debt Resolution)
> **Status:** Done
> **Priority:** P2 - Alto
> **Estimate:** 6 horas
> **Assignee:** @dev

---

## Description

Implementar sistema de tema dark/light para o Health Dashboard, permitindo que usuários alternem entre os modos escuro e claro, com persistência da preferência e respeito à configuração do sistema operacional.

### Problem Statement

O Health Dashboard só tinha um tema escuro, sem opção para usuários que preferem tema claro ou que precisam de maior contraste por questões de acessibilidade.

## Acceptance Criteria

```gherkin
Feature: Sistema de Tema

Scenario: Toggle de tema funcional
  Given o usuário está no dashboard
  When clica no botão de tema
  Then o tema deve alternar entre dark e light
  And a preferência deve ser salva no localStorage

Scenario: Persistência de tema
  Given o usuário selecionou um tema
  When recarrega a página
  Then o tema selecionado deve ser mantido

Scenario: Preferência do sistema
  Given o usuário não selecionou um tema
  And o sistema operacional está em modo claro
  When acessa o dashboard
  Then o tema light deve ser aplicado

Scenario: Transição suave
  Given o usuário alterna o tema
  When a mudança ocorre
  Then deve haver transição suave entre os temas
```

## Scope

### In Scope

- Criar variáveis CSS para tema light
- Criar hook useTheme para gerenciar tema
- Criar componente ThemeToggle
- Integrar no Header
- Respeitar prefers-color-scheme
- Persistir preferência no localStorage
- Transições suaves entre temas

### Out of Scope

- Temas customizados pelo usuário
- Múltiplos esquemas de cores
- Sincronização de tema entre abas
- Tema high-contrast separado

## Tasks

- [x] Criar variáveis CSS para tema light
- [x] Adicionar data-theme attribute support
- [x] Implementar prefers-color-scheme media query
- [x] Criar hook useTheme.js
- [x] Criar ThemeContext.jsx
- [x] Criar componente ThemeToggle.jsx
- [x] Criar ThemeToggle.css
- [x] Atualizar hooks/index.js
- [x] Atualizar components/shared/index.js
- [x] Integrar ThemeProvider no App.jsx
- [x] Adicionar ThemeToggle no Header
- [x] Adicionar transições suaves
- [x] Atualizar Header.css

## File List

| Arquivo | Ação | Status |
|---------|------|--------|
| `src/styles/index.css` | Adicionar tema light | ✅ Atualizado |
| `src/hooks/useTheme.js` | Criar hook | ✅ Criado |
| `src/context/ThemeContext.jsx` | Criar context | ✅ Criado |
| `src/components/shared/ThemeToggle.jsx` | Criar componente | ✅ Criado |
| `src/components/shared/ThemeToggle.css` | Criar estilos | ✅ Criado |
| `src/hooks/index.js` | Exportar useTheme | ✅ Atualizado |
| `src/components/shared/index.js` | Exportar ThemeToggle | ✅ Atualizado |
| `src/App.jsx` | Integrar ThemeProvider | ✅ Atualizado |
| `src/components/shared/Header.jsx` | Adicionar ThemeToggle | ✅ Atualizado |
| `src/components/shared/Header.css` | Ajustar layout | ✅ Atualizado |

## Dev Notes

### Estrutura de Arquivos

```
src/
├── context/
│   └── ThemeContext.jsx    # Novo
├── hooks/
│   ├── useTheme.js         # Novo
│   └── index.js            # Atualizado
├── components/shared/
│   ├── ThemeToggle.jsx     # Novo
│   ├── ThemeToggle.css     # Novo
│   ├── Header.jsx          # Atualizado
│   ├── Header.css          # Atualizado
│   └── index.js            # Atualizado
├── styles/
│   └── index.css           # Atualizado (tema light)
└── App.jsx                 # Atualizado
```

### Variáveis CSS por Tema

**Dark (default):**
```css
--color-bg-primary: #0f172a;
--color-bg-secondary: #1e293b;
--color-text-primary: #f8fafc;
```

**Light:**
```css
--color-bg-primary: #f8fafc;
--color-bg-secondary: #ffffff;
--color-text-primary: #0f172a;
```

### Hook useTheme API

```javascript
const {
  theme,        // 'dark' | 'light'
  setTheme,     // (theme: string) => void
  toggleTheme,  // () => void
  isDark,       // boolean
  isLight,      // boolean
} = useThemeContext();
```

### Recursos

- ✅ Toggle manual (botão)
- ✅ Persistência (localStorage)
- ✅ Preferência do sistema (prefers-color-scheme)
- ✅ Transição suave (CSS transitions)
- ✅ Acessibilidade (aria-label)

## Definition of Done

- [x] Tema light implementado
- [x] Toggle funcional
- [x] Persistência no localStorage
- [x] prefers-color-scheme respeitado
- [x] Transições suaves
- [x] Context API integrada
- [x] Story atualizada

## Change Log

| Data | Agente | Mudança |
|------|--------|---------|
| 2026-02-20 | @dev | Criar variáveis CSS tema light |
| 2026-02-20 | @dev | Adicionar data-theme support |
| 2026-02-20 | @dev | Criar hook useTheme.js |
| 2026-02-20 | @dev | Criar ThemeContext.jsx |
| 2026-02-20 | @dev | Criar ThemeToggle.jsx + CSS |
| 2026-02-20 | @dev | Atualizar exports (hooks, components) |
| 2026-02-20 | @dev | Integrar ThemeProvider no App |
| 2026-02-20 | @dev | Adicionar ThemeToggle no Header |
| 2026-02-20 | @dev | Adicionar transições suaves |
| 2026-02-20 | @dev | Story marcada como Done |

---

*Story criada e completada por @dev | Epic EPIC-TD-001*
*Synkra AIOS v4.2.13*
