# Story TD-007: Audit de Acessibilidade do Health Dashboard

> **Story ID:** TD-007
> **Epic:** EPIC-TD-001 (Technical Debt Resolution)
> **Status:** Done
> **Priority:** P2 - Alto
> **Estimate:** 4 horas
> **Assignee:** @dev

---

## Description

Realizar audit de acessibilidade no Health Dashboard seguindo WCAG 2.1 nível AA, identificando e corrigindo problemas de acessibilidade para usuários com deficiências.

### Problem Statement

O Health Dashboard não tinha sido avaliado quanto à acessibilidade, potencialmente excluindo usuários que dependem de tecnologias assistivas como screen readers ou navegação por teclado.

## Acceptance Criteria

```gherkin
Feature: Audit de Acessibilidade

Scenario: Elementos interativos acessíveis por teclado
  Given um usuário navega por teclado
  When acessa o dashboard
  Then todos os elementos interativos devem ser focáveis
  And devem ter indicador de foco visível

Scenario: Screen readers anunciam conteúdo
  Given um usuário de screen reader
  When navega pelo dashboard
  Then loading states devem ser anunciados
  And erros devem ser anunciados
  And progresso do score deve ser anunciado

Scenario: Semântica correta
  Given a estrutura HTML
  When verifico landmarks e roles
  Then devem existir roles corretas (banner, nav, main)
  And elementos decorativos devem ter aria-hidden
```

## Scope

### In Scope

- Audit manual de componentes principais
- Correção de problemas WCAG 2.1 nível AA
- Adicionar suporte a navegação por teclado
- Adicionar atributos ARIA necessários
- Respeitar preferência de reduced motion

### Out of Scope

- Testes automatizados de acessibilidade (axe-core)
- Testes com screen readers reais
- Implementar tema high contrast
- Certificação formal de acessibilidade

## Tasks

- [x] Audit Dashboard.jsx
- [x] Audit Header.jsx
- [x] Audit Card.jsx
- [x] Audit HealthScore.jsx
- [x] Audit IssuesList.jsx
- [x] Audit DomainCard.jsx
- [x] Adicionar role="status" para loading
- [x] Adicionar role="alert" para errors
- [x] Adicionar aria-label em botões
- [x] Associar labels com inputs
- [x] Adicionar aria-pressed em filtros
- [x] Tornar cards acessíveis por teclado
- [x] Adicionar role="progressbar" no HealthScore
- [x] Adicionar focus-visible styles
- [x] Adicionar reduced-motion support
- [x] Criar documento de audit

## File List

| Arquivo | Ação | Status |
|---------|------|--------|
| `src/pages/Dashboard.jsx` | Corrigir a11y | ✅ Atualizado |
| `src/components/shared/Header.jsx` | Corrigir a11y | ✅ Atualizado |
| `src/components/shared/Card.jsx` | Adicionar keyboard support | ✅ Atualizado |
| `src/components/HealthScore.jsx` | Adicionar progressbar role | ✅ Atualizado |
| `src/components/IssuesList.jsx` | Corrigir a11y | ✅ Atualizado |
| `src/components/DomainCard.jsx` | Adicionar keyboard support | ✅ Atualizado |
| `src/styles/index.css` | Adicionar a11y styles | ✅ Atualizado |
| `docs/qa/accessibility-audit-2026-02-20.md` | Criar documento | ✅ Criado |

## Dev Notes

### Issues Corrigidos (12)

| # | Issue | Severidade | WCAG |
|---|-------|------------|------|
| 1 | Loading sem role="status" | CRITICAL | 4.1.3 |
| 2 | Error sem role="alert" | CRITICAL | 4.1.3 |
| 3 | Botões sem aria-label | HIGH | 2.4.6 |
| 4 | Checkbox sem ID associado | HIGH | 1.3.1 |
| 5 | Filtros sem aria-pressed | MEDIUM | 4.1.2 |
| 6 | Card sem role/tabIndex | HIGH | 2.1.1 |
| 7 | HealthScore sem progressbar | MEDIUM | 4.1.2 |
| 8 | Nav sem aria-label | MEDIUM | 1.3.1 |
| 9 | Ícones sem aria-hidden | LOW | 1.1.1 |
| 10 | Falta focus-visible | HIGH | 2.4.7 |
| 11 | Sem reduced-motion | MEDIUM | 2.3.3 |
| 12 | Listas sem aria-labelledby | LOW | 1.3.1 |

### CSS de Acessibilidade Adicionado

```css
/* Focus visible */
:focus-visible {
  outline: 2px solid var(--color-info);
  outline-offset: 2px;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}

/* Screen reader only */
.sr-only { ... }
```

### Componentes Atualizados

**Card.jsx** - Novo props:
- `role` - Para cards clicáveis
- `tabIndex` - Para foco por teclado
- `onKeyDown` - Para ativação por Enter/Space
- `ariaLabel` - Para screen readers

**HealthScore.jsx** - Atributos ARIA:
- `role="progressbar"`
- `aria-valuenow`, `aria-valuemin`, `aria-valuemax`
- `aria-label` descritivo

**IssuesList.jsx** - Melhorias:
- `aria-pressed` em botões de filtro
- `aria-labelledby` na lista
- `aria-label` em botões de ação

## Definition of Done

- [x] 12 issues de acessibilidade corrigidos
- [x] 6 componentes atualizados
- [x] CSS de acessibilidade adicionado
- [x] Documento de audit criado
- [x] Focus visible implementado
- [x] Reduced motion respeitado
- [x] Story atualizada

## Change Log

| Data | Agente | Mudança |
|------|--------|---------|
| 2026-02-20 | @dev | Audit inicial - 12 issues identificados |
| 2026-02-20 | @dev | Corrigir Dashboard.jsx (loading, error, checkbox) |
| 2026-02-20 | @dev | Corrigir Header.jsx (nav, aria-label) |
| 2026-02-20 | @dev | Atualizar Card.jsx (keyboard support) |
| 2026-02-20 | @dev | Atualizar HealthScore.jsx (progressbar role) |
| 2026-02-20 | @dev | Corrigir IssuesList.jsx (aria-pressed, labels) |
| 2026-02-20 | @dev | Atualizar DomainCard.jsx (keyboard, aria-label) |
| 2026-02-20 | @dev | Adicionar CSS de acessibilidade |
| 2026-02-20 | @dev | Criar documento de audit |
| 2026-02-20 | @dev | Story marcada como Done |

---

*Story criada e completada por @dev | Epic EPIC-TD-001*
*Synkra AIOS v4.2.13*
