# Story TD-010: Consolidar Dependências

> **Story ID:** TD-010
> **Epic:** EPIC-TD-001 (Technical Debt Resolution)
> **Status:** Done
> **Priority:** P2 - Alto
> **Estimate:** 7 horas
> **Assignee:** @dev

---

## Description

Consolidar e organizar as dependências do HUB, removendo arquivos de dependências soltos na raiz e documentando a estrutura de dependências Node.js e Python.

### Problem Statement

O HUB tinha package.json, node_modules e .venv soltos na raiz, criando poluição e confusão sobre onde as dependências deveriam estar. Além disso, não havia documentação clara da estrutura de dependências.

## Acceptance Criteria

```gherkin
Feature: Dependências Organizadas

Scenario: Raiz limpa
  Given a raiz do HUB
  When verifico os arquivos
  Then não deve haver package.json
  And não deve haver node_modules
  And não deve haver .venv

Scenario: Dependências isoladas
  Given as ferramentas do AIOS
  When verifico a estrutura
  Then cada ferramenta deve ter suas deps em .aios-tools/<ferramenta>/
  And projetos devem ter deps em projects/<projeto>/

Scenario: Documentação existente
  Given preciso entender a estrutura
  When consulto a documentação
  Then deve existir docs/architecture/dependency-structure.md
```

## Scope

### In Scope

- Mover package.json da raiz para .aios-tools/browser-deps/
- Remover node_modules da raiz
- Remover .venv vazio da raiz
- Atualizar .gitignore com patterns Python
- Documentar estrutura de dependências

### Out of Scope

- Consolidar .venv duplicados (legítimos)
- Criar requirements.txt central
- Migrar para workspace/npm workspaces

## Tasks

- [x] Identificar package.json dispersos
- [x] Identificar .venv dispersos
- [x] Criar .aios-tools/browser-deps/
- [x] Mover package.json para .aios-tools/browser-deps/
- [x] Remover node_modules da raiz
- [x] Remover .venv vazio da raiz
- [x] Atualizar .gitignore com patterns Python
- [x] Criar docs/architecture/dependency-structure.md

## File List

| Arquivo | Ação | Status |
|---------|------|--------|
| `package.json` (raiz) | Mover | ✅ Movido |
| `package-lock.json` (raiz) | Mover | ✅ Movido |
| `node_modules/` (raiz) | Remover | ✅ Removido |
| `.venv/` (raiz) | Remover | ✅ Removido |
| `.gitignore` | Atualizar | ✅ Atualizado |
| `docs/architecture/dependency-structure.md` | Criar | ✅ Criado |

## Dev Notes

### Antes

```
D:/workspace/
├── package.json          ← SOLTO NA RAIZ
├── package-lock.json     ← SOLTO NA RAIZ
├── node_modules/         ← NA RAIZ
├── .venv/                ← VAZIO NA RAIZ
└── ...
```

### Depois

```
D:/workspace/
├── .aios-tools/
│   └── browser-deps/
│       ├── package.json      ← Movido
│       └── package-lock.json ← Movido
├── .venv-browser/            ← Mantido (legítimo)
├── docs/architecture/
│   └── dependency-structure.md  ← Novo
└── [RAIZ LIMPA]
```

### .gitignore Atualizado

Adicionados patterns:
```gitignore
# Dependencies - Python (AIOS)
.venv/
.venv-*/
__pycache__/
*.py[cod]
*.so
.Python
*.egg-info/

# AIOS Tools (local installs)
.aios-tools/**/.venv/
.aios-tools/**/node_modules/
.aios-tools/uv-cache/
```

### Estrutura de Dependências Documentada

Ver: `docs/architecture/dependency-structure.md`

**Regras principais:**
1. HUB raiz NÃO tem package.json ou .venv
2. Ferramentas ficam em `.aios-tools/<ferramenta>/`
3. Projetos ficam em `projects/<projeto>/`

### Arquivos na Raiz (Final)

```
.env            # No .gitignore
.env.example    # Trackeado
.gitignore      # Atualizado
AGENTS.md       # Documentação
HUB-README.md   # Documentação
```

## Definition of Done

- [x] package.json movido da raiz
- [x] node_modules removido da raiz
- [x] .venv removido da raiz
- [x] .gitignore atualizado
- [x] Documentação criada
- [x] Raiz limpa verificada
- [x] Story atualizada

## Change Log

| Data | Agente | Mudança |
|------|--------|---------|
| 2026-02-20 | @dev | Audit de package.json (19 encontrados) |
| 2026-02-20 | @dev | Audit de .venv (3 encontrados) |
| 2026-02-20 | @dev | Criar .aios-tools/browser-deps/ |
| 2026-02-20 | @dev | Mover package.json + lock |
| 2026-02-20 | @dev | Remover node_modules da raiz |
| 2026-02-20 | @dev | Remover .venv vazio |
| 2026-02-20 | @dev | Atualizar .gitignore |
| 2026-02-20 | @dev | Criar dependency-structure.md |
| 2026-02-20 | @dev | Story marcada como Done |

---

*Story criada e completada por @dev | Epic EPIC-TD-001*
*Synkra AIOS v4.2.13*
